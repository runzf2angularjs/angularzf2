<?php
$this->assets('autocomplete');
$active = (!$this->search) ? ' style="display:none;" ' : '';
?>
<h1><?=__('Resource List') ?></h1>

<div class="panel panel-default">
    <div class="panel-heading" style="cursor: pointer;" onclick="$('#panel-body-search-resource').toggle();">
        <h3 class="panel-title"><?=__('Search') ?></h3>
    </div>
    <div id="panel-body-search-resource" class="panel-body" <?=$active?>>
        <?= $this->smartForm($form) ?>
    </div>
</div>

<div class="table-responsive">
    <table class="table table-striped table-hover table-condensed">
        <thead>
            <tr>
                <th width="30%"><?=__('Name') ?></th>
                <th width="20%"><?=__('Module') ?></th>
                <th><?=__('Controller') ?></th>
                <th width="20%"><?=__('Action') ?></th>
                <th style="width: 100px;"><?=__('Actions') ?></th>
            </tr>
        </thead>
        <tbody>
            <?php foreach ($this->paginator as $resource) : ?>
                <?php $data = Oft\Util\Acl::getMvcResourceFromString($resource->name); ?>
                <tr>
                    <td>
                        <?php if ($this->access['view']) : ?>
                        <a href="<?=$this->smartUrlFromRoute('resources.view', array('id' => $resource->id_acl_resource))?>"><?= e($resource->name) ?></a>
                        <?php else : ?>
                        <?= e($resource->name) ?>
                        <?php endif; ?>
                    </td>
                    <td><?= e($data['module']) ?></td>
                    <td><?= e($data['controller']) ?></td>
                    <td><?= e($data['action']) ?></td>
                    <td>
                        <?php if ($this->access['edit']) : ?>
                        <a href="<?=$this->smartUrlFromRoute('resources.edit', array('id' => $resource->id_acl_resource))?>" class="btn glyphicon glyphicon-cog"></a>
                        <?php endif; ?>
                        <?php if ($this->access['delete']) : ?>
                        <a href="<?=$this->smartUrlFromRoute('resources.delete', array('id' => $resource->id_acl_resource))?>" class="btn glyphicon glyphicon-trash"></a>
                        <?php endif; ?>
                    </td>
                </tr>
            <?php endforeach; ?>
        </tbody>
    </table>
</div>

<?= $this->paginationControl(
    $this->paginator,
    'Sliding',
    'oft/partials/sliding',
    array('url' => $this->smartUrlFromRoute('resources.list'))
); ?>

<div class="text-right">
    <?php if ($this->access['create']) : ?>
    <a href="<?=$this->smartUrlFromRoute('resources.create')?>" class="btn btn-primary"><?=__('Create') ?></a>
    <?php endif; ?>
</div>
